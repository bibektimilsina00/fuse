(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{18300:(e,t,r)=>{"use strict";r.d(t,{iZ:()=>c,vz:()=>l,Wn:()=>d,LR:()=>h});var s=r(32842),n=r(35625),a=r(48934),o=r(61899);let i={async login(e){let t=new URLSearchParams;t.append("username",e.email),t.append("password",e.password);let r=await o.uE.postFormData("/login/access-token",t);return o.uE.setToken(r.access_token),r},register:async e=>o.uE.post("/register",e),getCurrentUser:async()=>o.uE.get("/users/me"),logout(){o.uE.setToken(null)}},u={all:["auth"],currentUser:()=>[...u.all,"current-user"]};function c(){return(0,s.I)({queryKey:u.currentUser(),queryFn:i.getCurrentUser,retry:!1,staleTime:3e5,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1})}function l(){let e=(0,n.jE)();return(0,a.n)({mutationFn:e=>i.login(e),onSuccess:()=>{e.invalidateQueries({queryKey:u.currentUser()})}})}function h(){let e=(0,n.jE)();return(0,a.n)({mutationFn:e=>i.register(e),onSuccess:()=>{e.invalidateQueries({queryKey:u.currentUser()})}})}function d(){let e=(0,n.jE)();return(0,a.n)({mutationFn:()=>(i.logout(),Promise.resolve()),onSuccess:()=>{e.clear()}})}},19417:(e,t,r)=>{"use strict";r.d(t,{AuthProvider:()=>i,useAuth:()=>u});var s=r(95155),n=r(12115),a=r(18300);let o=(0,n.createContext)(void 0);function i({children:e}){let{data:t,isLoading:r,error:n}=(0,a.iZ)(),i=(0,a.Wn)(),u=n?null:t??null;return(0,s.jsx)(o.Provider,{value:{user:u,isLoading:!n&&r,isAuthenticated:!!u,logout:()=>i.mutate()},children:e})}function u(){let e=(0,n.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},25336:(e,t,r)=>{"use strict";r.d(t,{X6:()=>o,aw:()=>a,vF:()=>n});class s{constructor(e="App"){this.prefix=e}formatMessage(e,t){let r=new Date().toISOString().split("T")[1].split(".")[0];return`[${r}] [${this.prefix}] ${e}: ${t}`}debug(e,t){}info(e,t){}warn(e,t){console.warn(this.formatMessage("WARN",e),t||"")}error(e,t,r){console.error(this.formatMessage("ERROR",e),t,r||"")}child(e){return new s(`${this.prefix}:${e}`)}}let n=new s("Automation"),a=n.child("Workflow");n.child("Validation");let o=n.child("WebSocket")},61899:(e,t,r)=>{"use strict";r.d(t,{hs:()=>n,uE:()=>c});var s=r(25336);let n="http://localhost:5678/api/v1",a={maxRetries:3,baseDelayMs:1e3,maxDelayMs:1e4,retryableStatuses:[408,429,500,502,503,504]};function o(e,t){let r=t.baseDelayMs*Math.pow(2,e),s=.3*Math.random()*r;return Math.min(r+s,t.maxDelayMs)}function i(e){return new Promise(t=>setTimeout(t,e))}class u{constructor(){this.token=null,this.retryConfig=a,this.token=localStorage.getItem("auth_token")}static getInstance(){return u.instance||(u.instance=new u),u.instance}setToken(e){this.token=e,e?localStorage.setItem("auth_token",e):localStorage.removeItem("auth_token")}getToken(){return this.token}setRetryConfig(e){this.retryConfig={...this.retryConfig,...e}}async request(e,t={},r=0){let a={"Content-Type":"application/json","X-Request-ID":0===r?crypto.randomUUID?crypto.randomUUID():`${Date.now()}-${Math.random().toString(36).substring(2,11)}`:t.headers?.["X-Request-ID"],...t.headers};this.token&&(a.Authorization=`Bearer ${this.token}`);try{var u;let c=await fetch(`${n}${e}`,{...t,headers:a});if(429===c.status){let n=c.headers.get("Retry-After");if(n&&r<this.retryConfig.maxRetries){let a=1e3*parseInt(n,10)||o(r,this.retryConfig);return s.vF.warn(`Rate limited on ${e}. Retrying after ${a}ms (attempt ${r+1})`),await i(a),this.request(e,t,r+1)}}if(!c.ok&&(u=c.status,this.retryConfig.retryableStatuses.includes(u))&&r<this.retryConfig.maxRetries){let n=o(r,this.retryConfig);return s.vF.warn(`Request failed with ${c.status} on ${e}. Retrying after ${n}ms (attempt ${r+1})`),await i(n),this.request(e,t,r+1)}if(!c.ok){let e=await c.json().catch(()=>({detail:"An error occurred"}));throw Error(e.detail||`HTTP error! status: ${c.status}`)}return c.json()}catch(a){let n=e.includes("/users/me")||e.includes("/login");if(a instanceof TypeError&&"Failed to fetch"===a.message&&r<this.retryConfig.maxRetries&&!n){let n=o(r,this.retryConfig);return s.vF.warn(`Network error on ${e}. Retrying after ${n}ms (attempt ${r+1})`),await i(n),this.request(e,t,r+1)}throw a}}async get(e){return this.request(e,{method:"GET"})}async post(e,t){return this.request(e,{method:"POST",body:t?JSON.stringify(t):void 0})}async postFormData(e,t){let r={"Content-Type":"application/x-www-form-urlencoded"};this.token&&(r.Authorization=`Bearer ${this.token}`);let s=await fetch(`${n}${e}`,{method:"POST",headers:r,body:t});if(!s.ok)throw Error((await s.json().catch(()=>({detail:"An error occurred"}))).detail||`HTTP error! status: ${s.status}`);return s.json()}async put(e,t){return this.request(e,{method:"PUT",body:JSON.stringify(t)})}async patch(e,t){return this.request(e,{method:"PATCH",body:JSON.stringify(t)})}async delete(e){return this.request(e,{method:"DELETE"})}}let c=u.getInstance()},66919:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var s=r(95155),n=r(12115),a=r(73321),o=r(19417);function i(){let e=(0,a.useRouter)(),{user:t,isLoading:r}=(0,o.useAuth)();return(0,n.useEffect)(()=>{r||(t?e.push("/dashboard"):e.push("/auth/login"))},[t,r,e]),(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"})})}},73321:(e,t,r)=>{"use strict";var s=r(74645);r.o(s,"useParams")&&r.d(t,{useParams:function(){return s.useParams}}),r.o(s,"usePathname")&&r.d(t,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(t,{useSearchParams:function(){return s.useSearchParams}})},99030:(e,t,r)=>{Promise.resolve().then(r.bind(r,66919))}},e=>{e.O(0,[275,441,794,358],()=>e(e.s=99030)),_N_E=e.O()}]);