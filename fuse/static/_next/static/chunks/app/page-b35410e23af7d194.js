(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8974],{18300:(t,e,s)=>{"use strict";s.d(e,{iZ:()=>h,vz:()=>c,Wn:()=>d,LR:()=>l});var r=s(32842),i=s(35625),n=s(48934),a=s(61899);let o={async login(t){let e=new URLSearchParams;e.append("username",t.email),e.append("password",t.password);let s=await a.uE.postFormData("/login/access-token",e);return a.uE.setToken(s.access_token),s},register:async t=>a.uE.post("/register",t),getCurrentUser:async()=>a.uE.get("/users/me"),logout(){a.uE.setToken(null)}},u={all:["auth"],currentUser:()=>[...u.all,"current-user"]};function h(){return(0,r.I)({queryKey:u.currentUser(),queryFn:o.getCurrentUser,retry:!1,staleTime:3e5,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1})}function c(){let t=(0,i.jE)();return(0,n.n)({mutationFn:t=>o.login(t),onSuccess:()=>{t.invalidateQueries({queryKey:u.currentUser()})}})}function l(){let t=(0,i.jE)();return(0,n.n)({mutationFn:t=>o.register(t),onSuccess:()=>{t.invalidateQueries({queryKey:u.currentUser()})}})}function d(){let t=(0,i.jE)();return(0,n.n)({mutationFn:()=>(o.logout(),Promise.resolve()),onSuccess:()=>{t.clear()}})}},19417:(t,e,s)=>{"use strict";s.d(e,{AuthProvider:()=>o,useAuth:()=>u});var r=s(95155),i=s(12115),n=s(18300);let a=(0,i.createContext)(void 0);function o({children:t}){let{data:e,isLoading:s,error:i}=(0,n.iZ)(),o=(0,n.Wn)(),u=i?null:e??null;return(0,r.jsx)(a.Provider,{value:{user:u,isLoading:!i&&s,isAuthenticated:!!u,logout:()=>o.mutate()},children:t})}function u(){let t=(0,i.useContext)(a);if(void 0===t)throw Error("useAuth must be used within an AuthProvider");return t}},25336:(t,e,s)=>{"use strict";s.d(e,{X6:()=>a,aw:()=>n,vF:()=>i});class r{constructor(t="App"){this.prefix=t}formatMessage(t,e){let s=new Date().toISOString().split("T")[1].split(".")[0];return`[${s}] [${this.prefix}] ${t}: ${e}`}debug(t,e){}info(t,e){}warn(t,e){console.warn(this.formatMessage("WARN",t),e||"")}error(t,e,s){console.error(this.formatMessage("ERROR",t),e,s||"")}child(t){return new r(`${this.prefix}:${t}`)}}let i=new r("Automation"),n=i.child("Workflow");i.child("Validation");let a=i.child("WebSocket")},48934:(t,e,s)=>{"use strict";s.d(e,{n:()=>c});var r=s(12115),i=s(53390),n=s(31967),a=s(98216),o=s(5858),u=class extends a.Q{#t;#e=void 0;#s;#r;constructor(t,e){super(),this.#t=t,this.setOptions(e),this.bindMethods(),this.#i()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){let e=this.options;this.options=this.#t.defaultMutationOptions(t),(0,o.f8)(this.options,e)||this.#t.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#s,observer:this}),e?.mutationKey&&this.options.mutationKey&&(0,o.EN)(e.mutationKey)!==(0,o.EN)(this.options.mutationKey)?this.reset():this.#s?.state.status==="pending"&&this.#s.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#s?.removeObserver(this)}onMutationUpdate(t){this.#i(),this.#n(t)}getCurrentResult(){return this.#e}reset(){this.#s?.removeObserver(this),this.#s=void 0,this.#i(),this.#n()}mutate(t,e){return this.#r=e,this.#s?.removeObserver(this),this.#s=this.#t.getMutationCache().build(this.#t,this.options),this.#s.addObserver(this),this.#s.execute(t)}#i(){let t=this.#s?.state??(0,i.$)();this.#e={...t,isPending:"pending"===t.status,isSuccess:"success"===t.status,isError:"error"===t.status,isIdle:"idle"===t.status,mutate:this.mutate,reset:this.reset}}#n(t){n.jG.batch(()=>{if(this.#r&&this.hasListeners()){let e=this.#e.variables,s=this.#e.context,r={client:this.#t,meta:this.options.meta,mutationKey:this.options.mutationKey};t?.type==="success"?(this.#r.onSuccess?.(t.data,e,s,r),this.#r.onSettled?.(t.data,null,e,s,r)):t?.type==="error"&&(this.#r.onError?.(t.error,e,s,r),this.#r.onSettled?.(void 0,t.error,e,s,r))}this.listeners.forEach(t=>{t(this.#e)})})}},h=s(35625);function c(t,e){let s=(0,h.jE)(e),[i]=r.useState(()=>new u(s,t));r.useEffect(()=>{i.setOptions(t)},[i,t]);let a=r.useSyncExternalStore(r.useCallback(t=>i.subscribe(n.jG.batchCalls(t)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),c=r.useCallback((t,e)=>{i.mutate(t,e).catch(o.lQ)},[i]);if(a.error&&(0,o.GU)(i.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:c,mutateAsync:a.mutate}}},53390:(t,e,s)=>{"use strict";s.d(e,{$:()=>o,s:()=>a});var r=s(31967),i=s(99190),n=s(9846),a=class extends i.k{#t;#a;#o;#u;constructor(t){super(),this.#t=t.client,this.mutationId=t.mutationId,this.#o=t.mutationCache,this.#a=[],this.state=t.state||o(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){this.#a.includes(t)||(this.#a.push(t),this.clearGcTimeout(),this.#o.notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){this.#a=this.#a.filter(e=>e!==t),this.scheduleGc(),this.#o.notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){this.#a.length||("pending"===this.state.status?this.scheduleGc():this.#o.remove(this))}continue(){return this.#u?.continue()??this.execute(this.state.variables)}async execute(t){let e=()=>{this.#h({type:"continue"})},s={client:this.#t,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#u=(0,n.II)({fn:()=>this.options.mutationFn?this.options.mutationFn(t,s):Promise.reject(Error("No mutationFn found")),onFail:(t,e)=>{this.#h({type:"failed",failureCount:t,error:e})},onPause:()=>{this.#h({type:"pause"})},onContinue:e,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#o.canRun(this)});let r="pending"===this.state.status,i=!this.#u.canStart();try{if(r)e();else{this.#h({type:"pending",variables:t,isPaused:i}),await this.#o.config.onMutate?.(t,this,s);let e=await this.options.onMutate?.(t,s);e!==this.state.context&&this.#h({type:"pending",context:e,variables:t,isPaused:i})}let n=await this.#u.start();return await this.#o.config.onSuccess?.(n,t,this.state.context,this,s),await this.options.onSuccess?.(n,t,this.state.context,s),await this.#o.config.onSettled?.(n,null,this.state.variables,this.state.context,this,s),await this.options.onSettled?.(n,null,t,this.state.context,s),this.#h({type:"success",data:n}),n}catch(e){try{throw await this.#o.config.onError?.(e,t,this.state.context,this,s),await this.options.onError?.(e,t,this.state.context,s),await this.#o.config.onSettled?.(void 0,e,this.state.variables,this.state.context,this,s),await this.options.onSettled?.(void 0,e,t,this.state.context,s),e}finally{this.#h({type:"error",error:e})}}finally{this.#o.runNext(this)}}#h(t){this.state=(e=>{switch(t.type){case"failed":return{...e,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...e,isPaused:!0};case"continue":return{...e,isPaused:!1};case"pending":return{...e,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...e,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...e,data:void 0,error:t.error,failureCount:e.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}})(this.state),r.jG.batch(()=>{this.#a.forEach(e=>{e.onMutationUpdate(t)}),this.#o.notify({mutation:this,type:"updated",action:t})})}};function o(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}},61899:(t,e,s)=>{"use strict";s.d(e,{hs:()=>i,uE:()=>h});var r=s(25336);let i="http://localhost:5678/api/v1",n={maxRetries:3,baseDelayMs:1e3,maxDelayMs:1e4,retryableStatuses:[408,429,500,502,503,504]};function a(t,e){let s=e.baseDelayMs*Math.pow(2,t),r=.3*Math.random()*s;return Math.min(s+r,e.maxDelayMs)}function o(t){return new Promise(e=>setTimeout(e,t))}class u{constructor(){this.token=null,this.retryConfig=n,this.token=localStorage.getItem("auth_token")}static getInstance(){return u.instance||(u.instance=new u),u.instance}setToken(t){this.token=t,t?localStorage.setItem("auth_token",t):localStorage.removeItem("auth_token")}getToken(){return this.token}setRetryConfig(t){this.retryConfig={...this.retryConfig,...t}}async request(t,e={},s=0){let n={"Content-Type":"application/json","X-Request-ID":0===s?crypto.randomUUID?crypto.randomUUID():`${Date.now()}-${Math.random().toString(36).substring(2,11)}`:e.headers?.["X-Request-ID"],...e.headers};this.token&&(n.Authorization=`Bearer ${this.token}`);try{var u;let h=await fetch(`${i}${t}`,{...e,headers:n});if(429===h.status){let i=h.headers.get("Retry-After");if(i&&s<this.retryConfig.maxRetries){let n=1e3*parseInt(i,10)||a(s,this.retryConfig);return r.vF.warn(`Rate limited on ${t}. Retrying after ${n}ms (attempt ${s+1})`),await o(n),this.request(t,e,s+1)}}if(!h.ok&&(u=h.status,this.retryConfig.retryableStatuses.includes(u))&&s<this.retryConfig.maxRetries){let i=a(s,this.retryConfig);return r.vF.warn(`Request failed with ${h.status} on ${t}. Retrying after ${i}ms (attempt ${s+1})`),await o(i),this.request(t,e,s+1)}if(!h.ok){let t,e=await h.json().catch(()=>({detail:"An error occurred"}));throw t=Array.isArray(e.detail)?e.detail.map(t=>t.msg||t.message||"Validation error").join(". "):"string"==typeof e.detail?e.detail:e.detail?.msg?e.detail.msg:e.message?e.message:`HTTP error! status: ${h.status}`,Error(t)}return h.json()}catch(n){let i=t.includes("/users/me")||t.includes("/login");if(n instanceof TypeError&&"Failed to fetch"===n.message&&s<this.retryConfig.maxRetries&&!i){let i=a(s,this.retryConfig);return r.vF.warn(`Network error on ${t}. Retrying after ${i}ms (attempt ${s+1})`),await o(i),this.request(t,e,s+1)}throw n}}async get(t){return this.request(t,{method:"GET"})}async post(t,e){return this.request(t,{method:"POST",body:e?JSON.stringify(e):void 0})}async postFormData(t,e){let s={"Content-Type":"application/x-www-form-urlencoded"};this.token&&(s.Authorization=`Bearer ${this.token}`);let r=await fetch(`${i}${t}`,{method:"POST",headers:s,body:e});if(!r.ok){let t=await r.json().catch(()=>({detail:"An error occurred"}));throw Error(Array.isArray(t.detail)?t.detail.map(t=>t.msg||t.message||"Validation error").join(". "):"string"==typeof t.detail?t.detail:t.detail?.msg?t.detail.msg:t.message?t.message:`HTTP error! status: ${r.status}`)}return r.json()}async put(t,e){return this.request(t,{method:"PUT",body:JSON.stringify(e)})}async patch(t,e){return this.request(t,{method:"PATCH",body:JSON.stringify(e)})}async delete(t){return this.request(t,{method:"DELETE"})}}let h=u.getInstance()},66919:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>o});var r=s(95155),i=s(12115),n=s(73321),a=s(19417);function o(){let t=(0,n.useRouter)(),{user:e,isLoading:s}=(0,a.useAuth)();return(0,i.useEffect)(()=>{s||(e?t.push("/dashboard"):t.push("/auth/login"))},[e,s,t]),(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"})})}},73321:(t,e,s)=>{"use strict";var r=s(74645);s.o(r,"useParams")&&s.d(e,{useParams:function(){return r.useParams}}),s.o(r,"usePathname")&&s.d(e,{usePathname:function(){return r.usePathname}}),s.o(r,"useRouter")&&s.d(e,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(e,{useSearchParams:function(){return r.useSearchParams}})},99030:(t,e,s)=>{Promise.resolve().then(s.bind(s,66919))}},t=>{t.O(0,[2842,8441,3794,7358],()=>t(t.s=99030)),_N_E=t.O()}]);